{% extends "base.html" %}
{% block content %}
<section class="max-w-4xl mx-auto px-4 py-10">
  <h1 class="text-2xl sm:text-3xl font-extrabold text-center mb-2">Profile Settings</h1>
  <p class="text-center text-zinc-400 mb-8">Manage your account and integrations</p>

  <!-- Personal info card -->
  <div class="glass border border-zinc-800 rounded-2xl overflow-hidden mb-6">
    <div class="bg-[var(--accent)]/95 px-5 py-4 flex items-center gap-3">
      <div class="h-10 w-10 rounded-full bg-white/95 grid place-items-center">
        <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="#0f0f14" stroke-width="2">
          <circle cx="12" cy="8" r="3"></circle>
          <path d="M4 20c1.5-4 5-6 8-6s6.5 2 8 6"></path>
        </svg>
      </div>
      <div>
        <div class="font-semibold">Personal Information</div>
        <div class="text-sm opacity-90">Update your profile details</div>
      </div>
    </div>

    <div class="p-5 space-y-4">
      <!-- Display-only (wire later) -->
      <div class="grid sm:grid-cols-2 gap-4">
        <div>
          <div class="text-sm text-zinc-400 mb-1">Full Name</div>
          <div class="px-3 py-2 rounded-lg bg-zinc-900/70 border border-zinc-800">
            {{ user.NAME if user and user.NAME is defined else '—' }}
          </div>
        </div>
        <div>
          <div class="text-sm text-zinc-400 mb-1">Email</div>
          <div class="px-3 py-2 rounded-lg bg-zinc-900/70 border border-zinc-800">
            {{ user.EMAIL if user and user.EMAIL is defined else '—' }}
          </div>
        </div>
      </div>

      <div>
        <div class="text-sm text-zinc-400 mb-1">Password</div>
        <div class="px-3 py-2 rounded-lg bg-zinc-900/70 border border-zinc-800">••••••••</div>
      </div>

      <div class="flex items-center gap-3 pt-2">
        <button class="px-4 py-2 rounded-lg bg-zinc-800 hover:bg-zinc-700" disabled>Cancel</button>
        <button class="px-4 py-2 rounded-lg bg-[var(--accent)] hover:brightness-110 font-semibold" disabled>Save Changes</button>
      </div>
    </div>
  </div>

  <!-- Connections card -->
  <div class="glass border border-zinc-800 rounded-2xl overflow-hidden">
    <div class="bg-[var(--accent)]/95 px-5 py-3 font-semibold">
      Connections
      <span class="block text-xs font-normal opacity-90">Manage your integrations</span>
    </div>

    <div class="p-4 space-y-4">
      <!-- Canvas LMS -->
      <div class="glass border border-zinc-800 rounded-xl p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-lg bg-orange-500/20 grid place-items-center">
            <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.8">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M4 4v15.5"/><path d="M20 22V6a2 2 0 0 0-2-2H6.5A2.5 2.5 0 0 0 4 6.5"/>
            </svg>
          </div>
          <div>
            <div class="font-semibold">Canvas LMS</div>
            <div class="text-sm text-zinc-400">Learning management</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          {% if canvas_connected %}
            <span class="text-xs px-2 py-1 rounded-full bg-green-600/20 border border-green-600/40">Connected</span>
            <button class="px-3 py-1.5 rounded-lg bg-zinc-800 hover:bg-zinc-700" onclick="unlinkCanvas()">Unlink</button>
          {% else %}
            <button class="px-3 py-1.5 rounded-lg bg-[var(--accent)]/85 hover:brightness-110" onclick="linkCanvas()">Link</button>
          {% endif %}
        </div>
      </div>

      <!-- Google Calendar -->
      <div class="glass border border-zinc-800 rounded-xl p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-lg bg-green-500/20 grid place-items-center">
            <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.8">
              <rect x="3" y="4" width="18" height="18" rx="2"></rect><path d="M16 2v4M8 2v4M3 10h18"></path>
            </svg>
          </div>
          <div>
            <div class="font-semibold">Google Calendar</div>
            <div class="text-sm text-zinc-400">Schedule management</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          {% if gcal_connected %}
            <span class="text-xs px-2 py-1 rounded-full bg-green-600/20 border border-green-600/40">Connected</span>
            <button class="px-3 py-1.5 rounded-lg bg-zinc-800 hover:bg-zinc-700" onclick="unlinkGcal()">Unlink</button>
          {% else %}
            <button class="px-3 py-1.5 rounded-lg bg-[var(--accent)]/85 hover:brightness-110" onclick="linkGcal()">Link</button>
          {% endif %}
        </div>
      </div>

      <!-- Google Drive -->
      <div class="glass border border-zinc-800 rounded-xl p-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-lg bg-blue-500/20 grid place-items-center">
            <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.8">
              <path d="M10 13a5 5 0 0 0 7.07 0l2.83-2.83a5 5 0 0 0-7.07-7.07L10 4"/>
              <path d="M14 11a5 5 0 0 0-7.07 0L4.1 13.83a5 5 0 1 0 7.07 7.07L14 20"/>
            </svg>
          </div>
          <div>
            <div class="font-semibold">Google Drive</div>
            <div class="text-sm text-zinc-400">Cloud storage access</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          {% if gdrive_connected %}
            <span class="text-xs px-2 py-1 rounded-full bg-green-600/20 border border-green-600/40">Connected</span>
            <button class="px-3 py-1.5 rounded-lg bg-zinc-800 hover:bg-zinc-700" onclick="unlinkGdrive()">Unlink</button>
          {% else %}
            <button class="px-3 py-1.5 rounded-lg bg-[var(--accent)]/85 hover:brightness-110" onclick="linkGdrive()">Link</button>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  async function linkGcal(){ await fetch('/api/integrations/gcal/link',   {method:'POST'}); location.reload(); }
  async function unlinkGcal(){ await fetch('/api/integrations/gcal/unlink', {method:'POST'}); location.reload(); }

  async function linkGdrive(){ await fetch('/api/integrations/gdrive/link',   {method:'POST'}); location.reload(); }
  async function unlinkGdrive(){ await fetch('/api/integrations/gdrive/unlink', {method:'POST'}); location.reload(); }

  async function linkCanvas(){
    await fetch('/api/integrations/canvas/save', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({enabled:true})
    });
    location.reload();
  }
  async function unlinkCanvas(){
    await fetch('/api/integrations/canvas/save', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({enabled:false})
    });
    location.reload();
  }
</script>
{% endblock %}